var window_start = document.querySelector(".window-start"), btn_start_game = document.querySelector(".btn-start-game"), btn_start_new = document.querySelector(".btn-start-new"), game = document.querySelector(".window-game"), currentPlayer = document.getElementById("curPlyr"), field = document.querySelector(".field"), modal = document.querySelector(".modal"), modalWndw = document.querySelector(".modalWind"), btnReset = document.querySelector(".btn-reset"), gamers = ["X", "O"], gamerNum = 0, stat = { X: 0, O: 0 }; function startGame(e) { resetField(); var t = function (e) { for (var t = [], n = 0; n < e; n++) { var r = document.createElement("div"); r.className = "row", t[n] = []; for (var i = 0; i < e; i++) { var o = document.createElement("div"); o.className = "col", r.appendChild(o), o.addEventListener("click", s), t[n][i] = o } field.appendChild(r) } return t }(e), n = function (e) { for (var t = [], n = 0; n < e.length; n++)for (var r = 0; r < e[n].length; r++)void 0 === t[r] && (t[r] = []), t[r][n] = e[n][r]; return t }(t), r = u(t), i = u(function (e) { for (var t = [], n = 0; n < e.length; n++)for (var r = e[n].length - 1; r >= 0; r--)void 0 === t[n] && (t[n] = []), t[n].push(e[n][r]); return t }(t)), o = t.concat(n, r, i); function a(e, t) { for (var n = 0; n < t.length; n++)for (var r = 4; r < t[n].length; r++)if (t[n][r - 4].innerHTML == e && t[n][r - 3].innerHTML == e && t[n][r - 2].innerHTML == e && t[n][r - 1].innerHTML == e && t[n][r].innerHTML == e) return !0; return !1 } function s() { this.innerHTML = gamers[gamerNum], this.removeEventListener("click", s), function (e, t) { for (var n = 0; n < e.length; n++)if (a(e[n], t)) { stat[e[n]] += 1, l(e[n]); break } }(gamers, o), ++gamerNum == gamers.length && (gamerNum = 0), currentPlayer.innerHTML = gamers[gamerNum] } function u(e) { for (var t = [], n = 0; n < e.length; n++)for (var r = 0; r < e[n].length; r++)void 0 === t[n + r] && (t[n + r] = []), t[n + r].push(e[n][r]); return t } function l(e) { (function (e) { modal.classList.add("active"), modalWndw.innerHTML = "Победил " + e, modal.addEventListener("click", (function () { modal.classList.remove("active"), c() })) })(e = "X" == e ? "Крестик" : "Нолик"), document.getElementById("sX").innerHTML = stat.X, document.getElementById("sO").innerHTML = stat.O } function c() { for (var e = field.querySelectorAll(".col"), t = 0; t < e.length; t++)e[t].innerHTML = "", e[t].addEventListener("click", s) } btnReset.onclick = function () { c() } } function resetField() { field.innerHTML = "" } btn_start_game.addEventListener("click", () => { startGame(document.querySelector(".numbCells-start").value); let e = gsap.timeline(); e.to(window_start, { y: "-100vh", duration: 1 }), e.to(game, { y: "-100vh", duration: 1 }, "-=0.7") }), btn_start_new.addEventListener("click", () => { startGame(document.querySelector(".numbCells").value) });